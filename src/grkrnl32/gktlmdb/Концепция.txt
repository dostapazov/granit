
Постараемся обозначить функциональность телемеханической БД низкого уровня и её
структуру.
База должна состоять из записей универсального формата для хранения состояния
телемеханических объектов переданных железом любого производителя.

1) Главный обработчик должен иметь след. прототип
   DWORD WINAPI main_handler(LPBYTE addr_from,DWORD addr_len,LPBYTE data,DWORD data_len);
   addr_from - куда отвечать в случае необходимости.
   addr_len  - длина адреса.
   data      - данные для обработки
   data_len  - размер данных для обработки


под объектами понимается дискретный или аналоговый параметр или гуппа параметров

адрес модуля в виде ПУ.КП.ФА.СБ
из чего состоит
индикатор изменений
время последнего изменения
время последнего приема данных
общее состояние диагностики
данные о состоянии объектов
данные персональной диагностики объектов
данные персональных изменений
блок параметров группы
имя группы

**********
* Важно! *
**********

Если в кадре для обработки отсутствует  диагностика модуля то она полагается       = 0 (Всё ОК)
Если в кадре для обработки отсутствует  персональная диагностика то она полагается = 0 (Всё ОК)
Значит поставщик данных для БД должен постоянно напоминать о персональной неиспавности




Индикатор изменений   - это маска изменившихся частей
параметры группы это набор флагов типа не обрабатывать, выведен из работы и пр.

Диагностика:
Бывает общая и персональная
Персональная - это диагностика каждого параметра в группе  

Общая по модулю
31 Нет данных
30 Нет связи с пу       <- Эти
29 пу не отвечает       <- флаги может снимать только ПУ
28 нет связи с кп       <- Эти
27 кп не отвечает       <-     флаги может снимать только КП
26 нет связи с модулем  <- Эти
25 модуль не отвечает   <-     флаги может снимать только модуль
24
23
22
21
20
19
18
17
16
   Частичная недостоверность  Устанавливаются путем сканирования подобъектов
15
14
13
12
11
10
9
8  Один из объектов (ТС или ТИТ) недостоверен

   Состояния                 Устанавливаются путем сканирования подобъектов

7  пу работает через резерв
6  Кп работает через резерв  ?
5
4

3
2
1  Команда ТУ/ТР отправлена
0  Подготовка к ТУ/ТР


Запуск БД.
При запуске по всем объектам устанавливается состояние диагностики нет данных
Далее осуществляется передача модеммеру команд вызова по объектам с установленным
состоянием диагностики нет данных.


Заказы и списки изменения.
Обработка изменений производится отдельной нитью в контексте tlmdb_low (TGKTlmDb).
По первому  вызову вызываемый адрес помещается в список заказов и  в список изменений
с особым флагом указывающим на то, что надо передать все содержимое подпадающее
под заказанный адрес( если он вещательный )

  



